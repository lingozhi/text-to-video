"use strict";(self.webpackChunkchat_web=self.webpackChunkchat_web||[]).push([[549],{8406:function(e,t,a){var n=a(8081),r=a.n(n),l=a(3645),i=a.n(l)()(r());i.push([e.id,".clipping-configuration-btn {\n  background: #ffffff;\n  border-radius: 4px 4px 4px 4px;\n  opacity: 1;\n  border: 1px solid #b2c2dc;\n  padding: 16px 16px 16px 16px;\n}\n.clipping-configuration-btn .input-set {\n  display: flex;\n  align-items: center;\n  width: 50%;\n}\n.clipping-configuration-btn .input-set .lable {\n  width: 164px;\n}\n.clipping-configuration-btn .input-set .ant-input {\n  margin: 10px 0;\n}\n",""]),t.Z=i},2799:function(e,t,a){var n=a(8081),r=a.n(n),l=a(3645),i=a.n(l)()(r());i.push([e.id,".drawing-production-draw {\n  display: flex;\n  flex-wrap: wrap;\n}\n.drawing-production-btn {\n  background: #ffffff;\n  border-radius: 4px 4px 4px 4px;\n  opacity: 1;\n  border: 1px solid #b2c2dc;\n  padding: 16px 16px 16px 16px;\n}\n.drawing-production-picture {\n  margin-top: 24px;\n  background: #ffffff;\n  border-radius: 4px 4px 4px 4px;\n  opacity: 1;\n  border: 1px solid #b2c2dc;\n  padding: 16px 16px 16px 16px;\n}\n.list {\n  display: flex;\n  margin: 10px 0;\n}\n.list .draw {\n  width: 150px;\n  margin-left: 50px;\n}\n.drawing-modal .btn {\n  margin: 10px;\n}\n.drawing-modal .ant-modal-footer {\n  display: none;\n}\n.drawing-image {\n  height: calc(100vh - 287px);\n  overflow-y: auto;\n  margin-top: 24px;\n  background: #ffffff;\n  border-radius: 4px 4px 4px 4px;\n  opacity: 1;\n  border: 1px solid #b2c2dc;\n  padding: 16px 16px 16px 16px;\n}\n.drawing-image .drawing-future {\n  height: 250px;\n  overflow-y: auto;\n}\n.drawing-image .drawing-texts {\n  height: 80px;\n  overflow-y: auto;\n}\n",""]),t.Z=i},4197:function(e,t,a){var n=a(8081),r=a.n(n),l=a(3645),i=a.n(l)()(r());i.push([e.id,".dubbing-production-btn {\n  background: #ffffff;\n  border-radius: 4px 4px 4px 4px;\n  opacity: 1;\n  border: 1px solid #b2c2dc;\n  padding: 16px 16px 16px 16px;\n}\n.dubbing-production-table {\n  margin-top: 24px;\n  background: #ffffff;\n  border-radius: 4px 4px 4px 4px;\n  opacity: 1;\n  border: 1px solid #b2c2dc;\n  padding: 16px 16px 16px 16px;\n  overflow-y: scroll;\n  height: calc(100vh - 237px);\n}\n.dubbing-modal .btn {\n  margin: 10px;\n}\n.dubbing-modal .ant-modal-footer {\n  display: none;\n}\n",""]),t.Z=i},1059:function(e,t,a){var n=a(8081),r=a.n(n),l=a(3645),i=a.n(l)()(r());i.push([e.id,".novel-treatment .input-role {\n  margin: 10px 0;\n}\n.novel-treatment .novel-treatment-btn {\n  background: #ffffff;\n  border-radius: 4px 4px 4px 4px;\n  opacity: 1;\n  border: 1px solid #b2c2dc;\n  padding: 16px 16px 16px 16px;\n}\n.novel-treatment .list {\n  width: 50% !important;\n}\n.novel-treatment .list .ipt {\n  width: 100% !important;\n  display: flex;\n  align-items: center;\n}\n.novel-treatment .list .ipt .anticon {\n  margin-left: 10px;\n}\n.novel-treatment .novel-treatment-form {\n  margin-top: 24px;\n  background: #ffffff;\n  border-radius: 4px 4px 4px 4px;\n  opacity: 1;\n  border: 1px solid #b2c2dc;\n  padding: 16px 16px 16px 16px;\n  height: calc(100vh - 287px);\n  overflow-x: auto;\n  display: flex;\n}\n.novel-treatment .novel-treatment-form .ant-card {\n  width: 300px;\n  flex: none !important;\n  overflow-y: auto;\n  margin: 0 16px;\n  box-shadow: 0px 0px 8px 0px rgba(13, 104, 254, 0.1);\n  opacity: 1;\n}\n.novel-treatment .novel-treatment-form .ant-form {\n  width: 100%;\n}\n.novel .treatment-modal .input-set {\n  display: flex;\n  align-items: center;\n}\n.novel .treatment-modal .input-set .lable {\n  width: 104px;\n}\n.novel .treatment-modal .input-set .ant-input {\n  width: 320px !important;\n  margin: 10px 0;\n}\n.novel .treatment-modal .no-show {\n  display: none;\n}\n.novel .ant-tag {\n  cursor: pointer;\n}\n.novel .ant-modal-footer {\n  display: none;\n}\n",""]),t.Z=i},3514:function(e,t,a){var n=a(8081),r=a.n(n),l=a(3645),i=a.n(l)()(r());i.push([e.id,"#components-layout-demo-top-side-2 .logo {\n  float: left;\n  width: 120px;\n  height: 31px;\n  margin: 16px 24px 16px 0;\n  background: rgba(255, 255, 255, 0.3);\n}\n.ant-row-rtl #components-layout-demo-top-side-2 .logo {\n  float: right;\n  margin: 16px 0 16px 24px;\n}\n.layout {\n  height: 100%;\n  overflow: hidden;\n}\n.home {\n  height: 100%;\n  overflow-y: auto;\n}\n.home .home_input {\n  margin: 16px 0;\n  width: 50%;\n}\n.home .home_input .input {\n  display: flex;\n  align-items: center;\n}\n.home .home_input .text {\n  flex: none;\n}\n.home .home_btn {\n  margin-bottom: 16px;\n}\n.home .home_btn .draw {\n  margin-right: 16px;\n}\n.handle {\n  width: 100px;\n}\n.editable-row .ant-form-item-explain {\n  position: absolute;\n  top: 100%;\n  font-size: 12px;\n}\n.ant-tabs {\n  height: 100% !important;\n}\n.ant-tabs-content {\n  height: 100% !important;\n}\n.ant-tabs-tabpane {\n  height: 100% !important;\n}\n",""]),t.Z=i},1549:function(e,t,a){a.r(t),a.d(t,{default:function(){return ve}});var n=a(3379),r=a.n(n),l=a(7795),i=a.n(l),o=a(569),s=a.n(o),c=a(3565),m=a.n(c),d=a(9216),u=a.n(d),p=a(4589),g=a.n(p),h=a(3514),f={};f.styleTagTransform=g(),f.setAttributes=m(),f.insert=s().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=u();r()(h.Z,f),h.Z&&h.Z.locals&&h.Z.locals;var b=a(7294),v=a(9742),x=a(6942),E=a(6143),y=a(9726),w=a(4466),Z=a(6646),_=a(9650),N=a(1577),S=a(3844),k=a(1242),C=a(7034),I=a(3332),z=a(1230),P=a(5746),T=a(9775),D=a(9676),A=a(7858),M=a(8648);(()=>{const e={}})(),(()=>{const e={}})();var q=a(7484),L=a.n(q),R=a(6671),F=a.n(R);const O={get(e){const t=document.cookie.split("; ");for(let a=0,n=t.length;a<n;a++){const n=t[a].split("=");if(n[0]===e)return n[1]}return null},set(e,t,a,n,r,l){let i=`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;a instanceof Date&&(i+=`; expires=${a.toGMTString()}`),n&&(i+=`; path=${n}`),r&&(i+=`; domain=${r}`),l&&(i+="; secure"),document.cookie=i},remove(e,t,a,n){this.set(e,"",new Date(0),t,a,n)},clear(){const e=document.cookie.match(/[^ =;]+(?=\=)/g);if(e)for(let t=e.length;t--;)document.cookie=`${e[t]}=0;path=/;expires=${new Date(0).toUTCString()}`}},V={set(e,t){localStorage.setItem(e,t)},setObj(e,t){localStorage.setItem(e,JSON.stringify(t))},get(e){return localStorage.getItem(e)?localStorage.getItem(e):null},getObj(e){return localStorage.getItem(e)?JSON.parse(localStorage.getItem(e)):null},remove(e){localStorage.removeItem(e)},clear(){localStorage.clear()}};L().extend(F());const K=()=>{localStorage.clear(),O.clear(),window.location.href="/login"};const J=M.Z.create({baseURL:"/to_video",timeout:3e8}),B=new Map,H=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{url:t,method:a,params:n,data:r}=e;return[t,a,JSON.stringify(n),JSON.stringify(r)].join("&")},$=e=>{const t=H(e);if(B.has(t)){B.get(t)(t),B.delete(t)}};J.interceptors.request.use((e=>{$(e),(e=>{const t=e,a=H(t);B.has(a)||(t.cancelToken=new M.Z.CancelToken((e=>{B.set(a,e)})))})(e);const t=e,a=V.get("electric-ops_token"),n=V.getObj("electric-ops_currentFactory");let r="";try{r=n.cid}catch(e){r=""}return a&&(t["Content-Type"]?t.headers["Content-Type"]=t["Content-Type"]:t.headers["Content-Type"]="application/json",t.headers.Authorization=a),"multipart/form-data"===t["Content-Type"]||("post"===t.method?void 0!==t.data?t.data={...t.data}:t.data={}:"get"===t.method&&(t.params?t.params={cid:r,...t.params}:t.params={cid:r})),t}),(e=>Promise.reject(e))),J.interceptors.response.use((e=>{$(e.config);const{status:t}=e;return 401===t&&K(),e.data}),(e=>{const{status:t}=e?.response||{};return 500===t?(w.ZP.destroy(),w.ZP.error("服务器异常")):401===t&&K(),Promise.reject(e)})),J.CancelToken=M.Z.CancelToken,J.isCancel=M.Z.isCancel;var j=J;var Y=a(2799),W={};W.styleTagTransform=g(),W.setAttributes=m(),W.insert=s().bind(null,"head"),W.domAPI=i(),W.insertStyleElement=u();r()(Y.Z,W),Y.Z&&Y.Z.locals&&Y.Z.locals;const{TextArea:G}=x.Z,{Option:U}=E.Z;var X=function(){const[e,t]=(0,b.useState)(!1),a=JSON.parse(localStorage.getItem("novelData"))||[],[n,r]=(0,b.useState)(null),[l,i]=(0,b.useState)(""),[o,s]=(0,b.useState)([]),[c,m]=(0,b.useState)(0),[d,u]=(0,b.useState)(!1),p=e=>{const t=o.map((t=>t.img_name===e.img_name?{...t,future:l}:t));s(t),r(null)},[g]=y.Z.useForm(),[h,f]=(0,b.useState)({sampler_name:"Euler",firstphase_width:"768",firstphase_height:"512",restore_faces:!1,enable_hr:!1,seed:-1,steps:25,cfg_scale:7,denoising_strength:.7,batch_size:1,hr_upscaler:"Latent",hr_second_pass_steps:0,hr_scale:2,negative_prompt:"EasyNegative, NSFW:1.5, badhandv4, worst quality, low quality:1.4, greyscale, border, artist name, zombie, EasyNegativeV2, badhandv4:1.2, nipples, face, make up, nsfw, naked, nude, bad fingers, worst quality, low quality:1.3, bad-hands-5, bad-image-v2-39000, bad-picture-chill-75v, bad_prompt_version2, BadDream, badhandv4, By bad artist -neg, EasyNegative, EasyNegativeV2, simple background, logo, watermark, text, fused fingers, too many fingers, crossed fingers, prolapse, low quality, worst quality:1.4, :0.8, monochrome:1.1, extra fingers, blurry, bad anatomy, bad proportions, lineart, monochrome, Bad Artist Anime:1.6, bad-hands-3:2, Bad Artist OG, Bad Image v4, Bad Prompt v2, :1.6, bad_quality, Deep Negative v1.75T, V2:1.6, negprompt5, ng_deepnegative_v1_75t, simple5.6, low quality, worst quality:1.4, bad anatomy, inaccurate limb:1.2, bad composition, inaccurate eyes, extra digit, fewer digits, extra arms:1.2, multiple heads, Extra fingers, High contrast, high saturation, out of frame, duplicate, watermark, signature, text, ugly, morbid, mutated, deformed, blurry, bad anatomy, bad proportions, cloned face, disfigured, fused fingers, fused limbs, too many fingers, long neck, Extra legs, multiple heads, twisted legs, Bad anatomy, bad human structure, Misaligned body structure, The third foot, the twisted face, the twisted foot, twisted toes, blurred face, twisted face, Defective body, incomplete body, Blurred toes, lowres, bad anatomy, bad hands, text, error, missing fingers, extra digit, fewer digits, cropped, worst quality, low"}),[v,A]=(0,b.useState)(""),[M,q]=(0,b.useState)(!1),L=async()=>{if(s([]),!v)return w.ZP.error("请输入SD地址"),void t(!1);w.ZP.success("开始制作，请查看终端！");try{const t=(await(e={sd_value:`${v}sdapi/v1/txt2img`,paint_set:h,fiction:a},j.post("/do_plot",e))).img_list.map((e=>({...e,redrawKey:0,isLoading:!1})));s(t)}catch(e){w.ZP.error(e),t(!1)}var e},R=async e=>{s((t=>t.map((t=>t.img_name===e.img_name?{...t,isLoading:!0}:t)))),e.future;await(t={image:e.img_name,paint_set:{...h,prompt:`((best quality)), ((masterpiece)), (detailed),${e.future}`}},j.post("/redraw_plot",t));var t;s((t=>t.map((t=>t.img_name===e.img_name?{...t,redrawKey:t.redrawKey+1,isLoading:!1}:t))))},F=()=>{q(!1)},O=()=>{q(!1)},V=e=>{if(e){const e=g.getFieldValue("firstphase_width"),t=g.getFieldValue("firstphase_height"),a=g.getFieldValue("hr_scale");g.setFieldsValue({hr_resize_x:e*a,hr_resize_y:t*a})}},K=()=>{if(d){const e=g.getFieldValue("firstphase_width"),t=g.getFieldValue("firstphase_height"),a=g.getFieldValue("hr_scale");g.setFieldsValue({hr_resize_x:e*a,hr_resize_y:t*a})}},J=()=>{if(d){const e=g.getFieldValue("hr_resize_x"),t=g.getFieldValue("hr_resize_y"),a=g.getFieldValue("hr_scale");g.setFieldsValue({firstphase_width:e/a,firstphase_height:t/a})}};return b.createElement(Z.Z,{spinning:e},b.createElement("div",{className:"drawing-production-btn"},b.createElement("div",{className:"list"},b.createElement(x.Z,{placeholder:"请输入stable diffusion地址",value:v,onChange:e=>{A(e.target.value)}})),b.createElement(_.Z,{wrap:!0},b.createElement(N.Z,{onClick:()=>{q(!0)}},"绘画设置"),b.createElement(S.Z,{title:""},b.createElement(N.Z,{onClick:()=>{L()}},"绘图制作")),b.createElement(N.Z,{onClick:async()=>{await j.get("/open_pictures",e);var e}},"打开图片文件夹"))),b.createElement("div",{className:"drawing-image"},b.createElement(_.Z,{wrap:!0},o.map((e=>b.createElement("div",{className:"gutter-row",span:6,key:e.img_name},b.createElement(Z.Z,{spinning:e.isLoading},b.createElement(k.Z,{style:{width:350},cover:b.createElement(C.Z,{width:350,src:`http://localhost:12002/to_video/images/${e.img_name}?redraw=${e.redrawKey}`}),actions:[b.createElement("div",{key:"edit",onClick:()=>(e=>{r(e),i(e.future)})(e)},"编辑"),n===e?b.createElement("div",{onClick:()=>p(e)},"保存"):b.createElement("div",{key:"edit2",onClick:()=>R(e)},"重绘")]},n===e?b.createElement(b.Fragment,null,b.createElement("div",{className:"drawing-texts"},e.texts),b.createElement("div",{className:"drawing-future"},b.createElement(G,{value:l,onChange:e=>i(e.target.value),onBlur:()=>p(e),autoSize:{minRows:10}}))):b.createElement(b.Fragment,null,b.createElement("div",{className:"drawing-texts"},e.texts),b.createElement("div",{className:"drawing-future"},e.future))))))))),b.createElement(I.Z,{title:"绘画设置",open:M,onOk:F,onCancel:O,className:"drawing-modal"},b.createElement(y.Z,{form:g,name:"dynamic_form",onFinish:e=>{f(e)},autoComplete:"off",initialValues:{sampler_name:"Euler",firstphase_width:"768",firstphase_height:"512",restore_faces:!1,enable_hr:!1,seed:-1,steps:25,cfg_scale:7,denoising_strength:.7,batch_size:1,hr_upscaler:"Latent",hr_second_pass_steps:0,hr_scale:2,negative_prompt:"EasyNegative, NSFW:1.5, badhandv4, worst quality, low quality:1.4, greyscale, border, artist name, zombie, EasyNegativeV2, badhandv4:1.2, nipples, face, make up, nsfw, naked, nude, bad fingers, worst quality, low quality:1.3, bad-hands-5, bad-image-v2-39000, bad-picture-chill-75v, bad_prompt_version2, BadDream, badhandv4, By bad artist -neg, EasyNegative, EasyNegativeV2, simple background, logo, watermark, text, fused fingers, too many fingers, crossed fingers, prolapse, low quality, worst quality:1.4, :0.8, monochrome:1.1, extra fingers, blurry, bad anatomy, bad proportions, lineart, monochrome, Bad Artist Anime:1.6, bad-hands-3:2, Bad Artist OG, Bad Image v4, Bad Prompt v2, :1.6, bad_quality, Deep Negative v1.75T, V2:1.6, negprompt5, ng_deepnegative_v1_75t, simple5.6, low quality, worst quality:1.4, bad anatomy, inaccurate limb:1.2, bad composition, inaccurate eyes, extra digit, fewer digits, extra arms:1.2, multiple heads, Extra fingers, High contrast, high saturation, out of frame, duplicate, watermark, signature, text, ugly, morbid, mutated, deformed, blurry, bad anatomy, bad proportions, cloned face, disfigured, fused fingers, fused limbs, too many fingers, long neck, Extra legs, multiple heads, twisted legs, Bad anatomy, bad human structure, Misaligned body structure, The third foot, the twisted face, the twisted foot, twisted toes, blurred face, twisted face, Defective body, incomplete body, Blurred toes, lowres, bad anatomy, bad hands, text, error, missing fingers, extra digit, fewer digits, cropped, worst quality, low"}},b.createElement(z.Z,{gutter:24},b.createElement(P.Z,{span:12},b.createElement(y.Z.Item,{name:"sampler_name",label:"采样器名称"},b.createElement(E.Z,{placeholder:"请选择采样器"},["Euler","LMS","Heun","DPM2","DPM++2S a","DPM++2M","SuperMerger","Dreambooth","DPM++ SDE","DPM++ 2M SDE","DPM fast","DPM adaptive","LMS Karras","DPM2 Karras","DPM2 a Karras","DPM++ 2S a Karras","DPM++ 2M Karras","DPM++ SDE Karras","DPM++ 2M SDE Karras","DDIM","PLMS","Unipc"].map(((e,t)=>b.createElement(U,{key:t,value:e},e))))),b.createElement(y.Z.Item,{name:"firstphase_width",label:"宽度"},b.createElement(T.Z,{min:0,onChange:K})),b.createElement(y.Z.Item,{name:"firstphase_height",label:"高度"},b.createElement(T.Z,{min:0,onChange:K})),b.createElement(y.Z.Item,{name:"denoising_strength",label:"重绘幅度(Denoising)"},b.createElement(T.Z,{min:0,max:1,step:.1})),b.createElement(y.Z.Item,{name:"tiling",label:"切片处理",valuePropName:"checked"},b.createElement(D.Z,null)),b.createElement(y.Z.Item,{name:"enable_hr",label:"高清修复",valuePropName:"checked"},b.createElement(D.Z,{onChange:e=>{return t=e.target.checked,u(t),void V(t);var t}})),b.createElement(y.Z.Item,{name:"hr_resize_x",label:"高清调整宽度",hidden:!d},b.createElement(T.Z,{min:0,onChange:J})),b.createElement(y.Z.Item,{name:"hr_resize_y",label:"高清调整高度",hidden:!d},b.createElement(T.Z,{min:0,onChange:J}))),b.createElement(P.Z,{span:12},b.createElement(y.Z.Item,{name:"seed",label:"种子"},b.createElement(T.Z,null)),b.createElement(y.Z.Item,{name:"steps",label:"迭代步骤"},b.createElement(T.Z,{min:1,max:150})),b.createElement(y.Z.Item,{name:"cfg_scale",label:"提示词相关性"},b.createElement(T.Z,null)),b.createElement(y.Z.Item,{name:"batch_size",label:"生成批次"},b.createElement(T.Z,{min:1})),b.createElement(y.Z.Item,{name:"restore_faces",label:"面部修复",valuePropName:"checked"},b.createElement(D.Z,null)),b.createElement(y.Z.Item,{name:"hr_scale",label:"放大倍率",hidden:!d},b.createElement(T.Z,{min:1,max:4,onChange:V})),b.createElement(y.Z.Item,{name:"hr_upscaler",label:"HR放大器",hidden:!d},b.createElement(E.Z,{placeholder:"请选择采样器"},["Latent","Latent (antialiased)","Latent (bicubic)","Latent (bicubic antialiased)","Latent (nearest)","Latent (nearest-exact)","None","Lanczos","Nearest","Dreambooth","ESRGAN_4x","LDSR","R-ESRGAN 4x+","R-ESRGAN 4x+Anime6B","ScuNET GAN","ScuNET PSNR","SwinIR 4x","ControlNet v1.1.206"].map(((e,t)=>b.createElement(U,{key:t,value:e},e))))),b.createElement(y.Z.Item,{name:"hr_second_pass_steps",label:"高清修复采样次数",hidden:!d},b.createElement(T.Z,{min:0,max:150}))),b.createElement(P.Z,{span:24},b.createElement(y.Z.Item,{name:"negative_prompt",label:"负面提示"},b.createElement(G,{autoSize:{minRows:8}})))),b.createElement(y.Z.Item,{wrapperCol:{offset:8,span:16}},b.createElement(N.Z,{onClick:O,className:"btn"},"取消"),b.createElement(N.Z,{type:"primary",htmlType:"submit",onClick:F,className:"btn"},"确认")))))},Q=a(314),ee=a(4197),te={};te.styleTagTransform=g(),te.setAttributes=m(),te.insert=s().bind(null,"head"),te.domAPI=i(),te.insertStyleElement=u();r()(ee.Z,te),ee.Z&&ee.Z.locals&&ee.Z.locals;const{Option:ae}=E.Z;var ne=function(){const[e,t]=(0,b.useState)(!1),[a,n]=(0,b.useState)({voice:"zh-CN-XiaoxiaoNeural",rate:"+30%",volume:"+0%"}),[r]=y.Z.useForm(),[l,i]=(0,b.useState)(0),[o,s]=(0,b.useState)([]),[c,m]=(0,b.useState)(!1),[d,u]=(0,b.useState)(0),p=async()=>{s([]);const e=localStorage.getItem("txt_path"),n=await(r={file_path:e,language:a},j.post("/do_voice",r));var r;s(n.audio_list),i((e=>e+1)),t(!1)},g=()=>{m(!1)},h=()=>{m(!1)},f=[{title:"段落",dataIndex:"text",key:"text"},{title:"语音",dataIndex:"voice_name",key:"voice_name",width:"20%",render:e=>b.createElement(b.Fragment,null,b.createElement("audio",{controls:!0,style:{width:"250px",height:"54px"}},b.createElement("source",{src:`http://localhost:12002/to_video/audio/${e}?redraw=${l}`,type:"audio/wav"})))},{title:"操作",dataIndex:"handle",render:(e,t)=>{const{storyboard:a,part:n,image_path:r}=t;return b.createElement("div",{className:"handle"},b.createElement("a",null,"语音重制"))}}];return b.createElement(Z.Z,{spinning:e},b.createElement("div",{className:"dubbing-production-btn"},b.createElement(_.Z,{wrap:!0},b.createElement(N.Z,{onClick:()=>{m(!0)}},"配音设置"),b.createElement(N.Z,{onClick:()=>{t(!0),p()}},"配音制作"),b.createElement(N.Z,{onClick:async()=>{await j.get("/open_voice",e);var e}},"打开语音文件夹"))),b.createElement("div",{className:"dubbing-production-table"},b.createElement(Q.Z,{columns:f,dataSource:o,bordered:!0,rowClassName:"editable-row",rowKey:e=>e.voice_name})),b.createElement(I.Z,{title:"配音设置",open:c,onOk:g,onCancel:h,className:"dubbing-modal"},b.createElement(y.Z,{form:r,name:"dynamic_form",onFinish:e=>{n(e)},autoComplete:"off",initialValues:{voice:"zh-CN-XiaoxiaoNeural",rate:"+30%",volume:"+0%"}},b.createElement(y.Z.Item,{label:"配音角色",name:"voice",rules:[{required:!0,message:"选中声音"}]},b.createElement(E.Z,{style:{width:200},onChange:e=>{},options:[{value:"zh-CN-XiaoxiaoNeural",label:"zh-CN-XiaoxiaoNeural"},{value:"zh-CN-XiaoyiNeural",label:"zh-CN-XiaoyiNeural"},{value:"zh-CN-YunjianNeural",label:"zh-CN-YunjianNeural"},{value:"zh-CN-YunxiNeural",label:"zh-CN-YunxiNeural"},{value:"zh-CN-YunxiaNeural",label:"zh-CN-YunxiaNeural"},{value:"zh-CN-YunyangNeural",label:"zh-CN-YunyangNeural"},{value:"zh-HK-HiuGaaiNeural",label:"zh-HK-HiuGaaiNeural"},{value:"zh-HK-HiuMaanNeural",label:"zh-HK-HiuMaanNeural"},{value:"zh-HK-WanLungNeural",label:"zh-HK-WanLungNeural"},{value:"zh-TW-HsiaoChenNeural",label:"zh-TW-HsiaoChenNeural"},{value:"zh-TW-YunJheNeural",label:"zh-TW-YunJheNeural"},{value:"zh-TW-HsiaoYuNeural",label:"zh-TW-HsiaoYuNeural"}]})),b.createElement(y.Z.Item,{label:"语音速率",name:"rate",rules:[{required:!0,message:"Please input the rate!"}]},b.createElement(x.Z,{placeholder:"+30%"})),b.createElement(y.Z.Item,{label:"正常音量",name:"volume",rules:[{required:!0,message:"Please input the volume!"}]},b.createElement(x.Z,{placeholder:"+0%"})),b.createElement(y.Z.Item,{wrapperCol:{offset:8,span:16}},b.createElement(N.Z,{onClick:h,className:"btn"},"取消"),b.createElement(N.Z,{type:"primary",htmlType:"submit",onClick:g,className:"btn"},"确认")))))},re=a(1059),le={};le.styleTagTransform=g(),le.setAttributes=m(),le.insert=s().bind(null,"head"),le.domAPI=i(),le.insertStyleElement=u();r()(re.Z,le),re.Z&&re.Z.locals&&re.Z.locals;var ie=a(9465),oe=a(6308),se=a(7294);var ce=e=>{let{card:t,onEdit:a,onReset:n}=e;return se.createElement(k.Z,{title:`索引: ${t.index}`,style:{width:300}},se.createElement("p",null,"部分：",t.part),se.createElement("p",null,"文本：",t.text),se.createElement("p",null,"翻译：",t.translate),se.createElement(N.Z,{onClick:()=>a(t)},"编辑"),se.createElement(N.Z,{onClick:()=>n(t)},"重置")," ")},me=a(7294);var de=e=>{let{card:t,onSave:a}=e;return me.createElement(y.Z,{initialValues:{text:t.text,translate:t.translate},onFinish:e=>{a({...t,...e})}},me.createElement(y.Z.Item,{name:"text",label:"文本",style:{width:"100%"}},me.createElement(x.Z.TextArea,{autoSize:{minRows:3,maxRows:5}})),me.createElement(y.Z.Item,{name:"translate",label:"翻译",style:{width:"100%"}},me.createElement(x.Z.TextArea,{autoSize:{minRows:5,maxRows:8}})),me.createElement(y.Z.Item,null,me.createElement(N.Z,{type:"primary",htmlType:"submit"},"保存")))},ue=a(1997);const{TextArea:pe}=x.Z;var ge=function(){const e=(0,A.I0)(),t=JSON.parse(localStorage.getItem("novelData"))||[],[a,n]=(0,b.useState)(t);e((0,ue.eJ)(t)),(0,b.useEffect)((()=>{localStorage.setItem("novelData",JSON.stringify(a))}),[a]);const[r,l]=(0,b.useState)(null),i=(0,b.useRef)(null),[o,s]=(0,b.useState)(0),[c,m]=(0,b.useState)("");(0,b.useEffect)((()=>{null===r&&(i.current.scrollLeft=o)}),[r,o]);const d=async t=>{try{const l=(await(r={part:t.part},j.post("/do_word",r))).data,i=a.map((e=>e.index===t.index?{...e,translate:l}:e));n(i),e((0,ue.eJ)(i))}catch(e){console.error("重置失败",e)}var r},[u,p]=(0,b.useState)([{id:Math.random(),value:"",placeholder:"请输入角色和角色特征如：张山=一位中年男子"}]),[g,h]=(0,b.useState)(""),[f,v]=(0,b.useState)(null),[E,y]=(0,b.useState)([]),[Z,k]=(0,b.useState)(""),[C,z]=(0,b.useState)(0),P=()=>{const e=Math.random();k(""),z("");const t={id:e,text:"",values:[""]};y([...E,t]),v(e),p([{id:e,value:"",placeholder:"请输入角色和角色特征如：张山=一位中年男子"}])},[T,D]=(0,b.useState)(!1),[M,q]=(0,b.useState)(!1),[L,R]=(0,b.useState)(!1),F=()=>{D(!1)},O=e=>{let{id:t,text:a,values:n,num:r}=e;v(t),k(a),z(r),p(n.map(((e,t)=>({id:t,value:e,placeholder:"请输入角色和角色特征如：张山=一位中年男子"}))))};(0,b.useEffect)((()=>{let e=localStorage.getItem("tags");e=e?JSON.parse(e):[],e.length?(y(e),O(e[0])):P()}),[]);const[V,K]=(0,b.useState)(localStorage.getItem("site")||""),[J,B]=(0,b.useState)(localStorage.getItem("key")||""),[H,$]=(0,b.useState)(!1),[Y,W]=(0,b.useState)(),[G,U]=(0,b.useState)(),[X,Q]=(0,b.useState)(!1);(0,b.useEffect)((()=>{const e=localStorage.getItem("key_api");e&&B(e)}),[]),(0,b.useEffect)((()=>{localStorage.setItem("key_api",J)}),[J]);const ee=function(e,t){let a;return function(){for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];clearTimeout(a),a=setTimeout((()=>e.apply(this,r)),t)}}((async()=>{n([]),e((0,ue.eJ)([]));const t=E.find((e=>e.id===f)),{values:a,num:r}=t,l=a.map((function(e){const t=e.split("=");return{[t[0]]:t[1]}})).reduce((function(e,t){return{...e,...t}}));try{const t=await(i={replace_dict:l,text_num:parseInt(r,10),api_key:J,textAreaValue:g},j.post("/do_free_video",i)),{data:a}=t;n(a),e((0,ue.eJ)(a))}catch(e){w.ZP.error("分镜制作失败，请重试！")}var i;$(!1)}),2e3);return b.createElement("div",{className:"novel-treatment"},b.createElement("div",{className:"novel-treatment-btn"},b.createElement("div",{className:"list"},b.createElement("div",{className:"ipt"},b.createElement(x.Z,{placeholder:"请输入key_api",value:J,onChange:e=>{B(e.target.value)}}))),b.createElement(_.Z,{wrap:!0},b.createElement(N.Z,{onClick:()=>{q(!0)}},"输入文章"),b.createElement(N.Z,{onClick:()=>{D(!0)}},"小说处理设置"),b.createElement(N.Z,{onClick:()=>{if(!J||0===g.length)return w.ZP.warning("请检查文章地址或者chatKey是否没有输入！"),void $(!1);$(!0),w.ZP.success("开始制作,请查看终端!"),ee()}},"制作分镜"),b.createElement(N.Z,{onClick:()=>{R(!0)}},"添加人物LORA"))),b.createElement("div",{className:"novel-treatment-form",ref:i},null!==r?b.createElement(de,{card:a[r],onSave:t=>{n(a.map(((e,a)=>a===r?t:e))),l(null),e((0,ue.eJ)(a.map(((e,a)=>a===r?t:e))))}}):a.map(((e,t)=>b.createElement(ce,{key:e.index,card:e,onEdit:()=>(e=>{s(i.current.scrollLeft),l(e)})(t),onReset:d})))),b.createElement(I.Z,{title:"小说处理设置",open:T,onOk:F,onCancel:()=>{D(!1)},className:"novel"},b.createElement("div",{className:"treatment-modal"},b.createElement("div",{className:"input-set"},b.createElement("div",{className:"lable"},"小说名字："),b.createElement(x.Z,{placeholder:"请输入小说名字",value:Z,onChange:e=>k(e.target.value)})),b.createElement("div",{className:"input-set no-show"},b.createElement("div",{className:"lable"},"语句合并字数："),b.createElement(x.Z,{placeholder:"请输入数字",value:C,onChange:e=>z(e.target.value)})),u.map((e=>b.createElement(_.Z,{key:e.id,style:{display:"flex"},align:"center",size:25},b.createElement("div",{className:"input-set"},b.createElement("div",{className:"lable"},"角色特征："),b.createElement(x.Z,{placeholder:e.placeholder,value:e.value,onChange:t=>{return a=e.id,n=t.target.value,void p(u.map((e=>e.id===a?{...e,value:n}:e)));var a,n}})),b.createElement(S.Z,{title:"删除"},b.createElement(ie.Z,{onClick:()=>{return t=e.id,void p(u.filter((e=>e.id!==t)));var t},style:{fontSize:"16px",color:"#999"}}))))),b.createElement(_.Z,{style:{display:"flex",justifyContent:"center",marginTop:"24px"}},b.createElement(N.Z,{onClick:()=>{p(u.concat({id:Math.random(),value:"",placeholder:"请输入角色和角色特征如：张山=一位中年男子"}))}},"添加角色特征"),b.createElement(N.Z,{onClick:()=>{(()=>{const e=E.map((e=>e.id===f?{...e,values:u.map((e=>e.value)),text:Z,num:C}:e));y(e),localStorage.setItem("tags",JSON.stringify(e))})(),F()}},"保存设置"),b.createElement(N.Z,{onClick:P},"添加新小说")),b.createElement("div",{style:{marginTop:16}},b.createElement(_.Z,{wrap:!0},E.map((e=>b.createElement("div",{key:e.id},b.createElement(oe.Z,{closable:!0,onClose:()=>(e=>{const t=E.filter((t=>t.id!==e));if(y(t),localStorage.setItem("tags",JSON.stringify(t)),e===f){const e=t.length>0?t[0]:null;v(e?e.id:null),e?(k(e.text),z(e.num),p(e.values.map(((e,t)=>({id:t,value:e,placeholder:"请输入角色和角色特征如：张山=一位中年男子"}))))):(k(""),z(),p([{id:u.length,value:"",placeholder:"请输入角色和角色特征如：张山=一位中年男子"}]))}})(e.id),style:{marginRight:8},onClick:()=>O(e),color:e.id===f?"success":""},e.text)))))))),b.createElement(I.Z,{title:"输入文章",open:M,onOk:()=>{q(!1)},onCancel:()=>{q(!1)},width:600},b.createElement(pe,{value:g,onChange:e=>h(e.target.value),placeholder:"输入小说",autoSize:{minRows:30}})),b.createElement(I.Z,{title:"添加人物Lora",open:L,onOk:()=>{const t=c.split("=");R(!1);const r=a.map((e=>e.part.includes(t[0])?{...e,translate:`${e.translate}${t[1]}`}:e));n(r),e((0,ue.eJ)(r)),w.ZP.success("已将lora添加到文本翻译最后")},onCancel:()=>{R(!1)},width:600},b.createElement(x.Z,{placeholder:"张三=<asasfasdf>",onChange:e=>m(e.target.value)})))},he=a(8406),fe={};fe.styleTagTransform=g(),fe.setAttributes=m(),fe.insert=s().bind(null,"head"),fe.domAPI=i(),fe.insertStyleElement=u();r()(he.Z,fe),he.Z&&he.Z.locals&&he.Z.locals;var be=function(){const[e,t]=(0,b.useState)("");return b.createElement("div",{className:"clipping-configuration-btn"},b.createElement("div",{className:"input-set"},b.createElement("div",{className:"lable"},"输入剪映草稿地址："),b.createElement(x.Z,{value:e,onChange:e=>{t(e.target.value)},placeholder:"如：C:\\Users\\12438\\AppData\\Local\\JianyingPro\\User Data\\Projects\\com.lveditor.draft\\7月23日\\draft_content.json"})),b.createElement(_.Z,{wrap:!0},b.createElement(N.Z,{className:"draw",onClick:async()=>{var t;200===(await(t={file_path:e},j.post("/do_align",t))).code?w.ZP.success("操作成功"):w.ZP.error("操作失败")}},"音视频对齐"),b.createElement(N.Z,{className:"draw",onClick:async()=>{var t;200===(await(t={file_path:e},j.post("/do_add_ykeys",t))).code?w.ZP.success("操作成功"):w.ZP.error("操作失败")}},"添加上下关键帧"),b.createElement(N.Z,{className:"draw",onClick:async()=>{var t;200===(await(t={file_path:e},j.post("/do_add_xkeys",t))).code?w.ZP.success("操作成功"):w.ZP.error("操作失败")}},"添加左右关键帧")))};var ve=function(){const e=[{key:"1",label:"小说处理",children:b.createElement(ge,null)},{key:"2",label:"绘画制作",children:b.createElement(X,null)},{key:"3",label:"配音制作",children:b.createElement(ne,null)},{key:"4",label:"剪映配置",children:b.createElement(be,null)}],t=new Date("2023-09-1T23:59:59");return(0,b.useEffect)((()=>{new Date>t&&(alert("应用程序已过期，请联系供应商。"),window.location.href="/expired")}),[]),b.createElement("div",{className:"home"},b.createElement(v.Z,{defaultActiveKey:"1",items:e}))}}}]);